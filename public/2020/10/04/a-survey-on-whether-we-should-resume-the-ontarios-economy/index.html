<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.75.1" />


<title>A survey on whether we should resume the Ontario&#39;s economy - 304 Assignment</title>
<meta property="og:title" content="A survey on whether we should resume the Ontario&#39;s economy - 304 Assignment">


  <link href='/favicon.ico' rel='icon' type='image/x-icon'/>



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About Me</a></li>
    
    <li><a href="https://github.com/liuluyao54">GitHub</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">13 min read</span>
    

    <h1 class="article-title">A survey on whether we should resume the Ontario&#39;s economy</h1>

    
    <span class="article-date">2020-10-04</span>
    

    <div class="article-content">
      


<div id="summary" class="section level1">
<h1>Summary</h1>
<p>COVID-19 disease, caused by severe acute respiratory syndrome Coronavirus 2 <span class="citation">(International and others <a href="#ref-of2020species" role="doc-biblioref">2020</a>)</span>, has had a huge impact on all aspects of our lives.</p>
<p>In this survey, we are going to find out different age groups’ opinions of resuming Ontario’s economy. The population is all registered residents in Ontario. One thousand samples will be taken and stratified sampling method is mainly considered according to the proportion of each age group.</p>
<p>We will email the questionnaire to each selected person. To encourage respondents to answer the questionnaire, we are willing to send 10 masks once they submitted the questionnaire. In addition, if a person refuse or ignore to finish the questionnaire, we will seek one more respondent from his/her age group until we achieve enough samples. To those elder people who may not be familiar to email, we will use the hand-copy questionnaire.</p>
<p>Respondents do not need to fill in any identifiable personal information, and we will also promise to protect the privacy of respondents in the questionnaire.</p>
<p>To be optimistic, we roughly need to contact at least 1,300 respondents in total. To each respondent, we need to pay for masks and postage that may cost about 7,000 to 8,000 dollars in total.</p>
</div>
<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>Our company will conduct a sample survey of the opinions of Ontario residents on the resuming plan. Stratified random sampling will be used as the sampling method and our questionnaire will includes 7 multiple choice questions concerning the gender, age, income, occupation, education, and the specific opinion of resuming. We will make analysis in terms of the relationship among the collected data and give some useful conclusions.</p>
</div>
<div id="survey-methodology" class="section level1">
<h1>2. Survey Methodology</h1>
<div id="survey-methods-theories" class="section level2">
<h2>2.1 Survey Methods Theories</h2>
<div id="simple-random-sampling-without-replacement" class="section level3">
<h3>(1) Simple Random Sampling Without Replacement</h3>
<p>In simple random sampling without replacement(SRSWOR), each sample unit of the population has only one chance to be selected in the sample. For example, if one draws a simple random sample such that no unit occurs more than one time in the sample, the sample is drawn without replacement.</p>
<p>Suppose we randomly select <span class="math inline">\(n\)</span> distinct units from the population of size <span class="math inline">\(N\)</span>, then</p>
<p>Probability of sample selection = <span class="math inline">\(\frac{1}{\left(\begin{array}{l}N \\ n\end{array}\right)}\)</span>, where <span class="math inline">\(\left(\begin{array}{l}N \\ n\end{array}\right) = \frac{N !}{(N-n) !}\)</span></p>
<p>Sample Mean = <span class="math inline">\(\bar{y}=\frac{1}{n} \sum_{i \in S} y_{i}\)</span>, which means sum all of the values of sample and then divided by the sample size.</p>
</div>
<div id="stratified-random-sampling" class="section level3">
<h3>(2) Stratified Random Sampling</h3>
<p>Stratified random sampling(SRS) is a method of sampling that involves the division of a population into smaller sub-groups known as strata <span class="citation">(Lohr <a href="#ref-lohr2009sampling" role="doc-biblioref">2009</a>)</span>. In stratified random sampling, or stratification, the strata are formed based on members’ shared attributes or characteristics such as income or educational attainment.</p>
<p>Assume there are <span class="math inline">\(H\)</span> (non-overlapping) strata, <span class="math inline">\(h\)</span> will represent a specific stratum, <span class="math inline">\(h=1,2,...,H\)</span></p>
<p><span class="math inline">\(N_{h}\)</span> is the population size of the <span class="math inline">\(h^{t h}\)</span> stratum.
<span class="math display">\[
N=\sum_{h=1}^{H} N_{h}
\]</span>
<span class="math inline">\(n_{h}\)</span> is the sample size of the <span class="math inline">\(h^{t h}\)</span> stratum.
<span class="math display">\[
n=\sum_{h=1}^{H} n_{h}
\]</span>
<span class="math inline">\(y_{h i}\)</span> is value of the study variable <span class="math inline">\(y\)</span> for unit <span class="math inline">\(i\)</span> in stratum <span class="math inline">\(h\)</span>.
<span class="math display">\[
i=1,2, \cdots, N_{h} ; \quad h=1,2, \cdots, H
\]</span></p>
<p>Population Mean for stratum <span class="math inline">\(h:\)</span>
<span class="math display">\[
\mu_{y h}=\frac{1}{N_{h}} \sum_{i=1}^{N_{h}} y_{h i}
\]</span>
which means sum the sample values in one stratum and then divided by its size.</p>
<p>Overall Population Mean:
<span class="math display">\[
\mu_{y}=\frac{1}{N} \sum_{h=1}^{H} \sum_{i=1}^{N_{h}} y_{h i}
\]</span>
which means sum the sample values in every stratum and then divided by the overall population size.</p>
</div>
</div>
<div id="survey-sampling-methods" class="section level2">
<h2>2.2 Survey Sampling Methods</h2>
<p>From Stats Canada, we can find out the percentages of each age group in Ontario. The percentages for age groups (0-19, 20-29, 30-39, 40-49, 50-59, 60-69, above 69) are (0.125, 0.135, 0.165, 0.150, 0.140, 0.145, 0.140). We then use Stratified Sampling by these weights to sample the data.</p>
<pre><code>## restart
##                      No      Yes and everywhere Yes but only some parts 
##                     298                     305                     397</code></pre>
</div>
</div>
<div id="results" class="section level1">
<h1>3. Results</h1>
<p>This survey collects data from 1000 valid respondents. Since the survey form cannot be submitted unless the respondent selects the answers to all the questions, we avoid missing values.</p>
<ol style="list-style-type: decimal">
<li>The frequency tables for Gender with regards to “Resuming” are shown as below. We can find most of the respondents agree to resume Ontario but only for some essential parts. Generally speaking, most of the people think Ontario should reopen.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="center">Gender</th>
<th align="center">No</th>
<th align="center">Yes and everywhere</th>
<th align="center">Yes but only some parts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Female</td>
<td align="center">143</td>
<td align="center">152</td>
<td align="center">195</td>
</tr>
<tr class="even">
<td align="center">Male</td>
<td align="center">142</td>
<td align="center">155</td>
<td align="center">193</td>
</tr>
<tr class="odd">
<td align="center">Other</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">94</td>
</tr>
<tr class="even">
<td align="center">Refuse to answer</td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">6</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>Since we split samples’ age to 7 groups, pie chart can have a better visualization patter. The Pie Charts with percentages for Age groups under different opinions to resume are shown below.</li>
</ol>
<ul>
<li><p>Resuming Opinion (<strong>No Resuming</strong>) to Different Age Levels (Figure 1)</p>
<p><img src="/post/A2-report_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Resuming Opinion (<strong>Conditionally Resuming</strong>) to Different Age Levels (Figure 2)</p>
<p><img src="/post/A2-report_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Resuming Opinion (<strong>Totally Resuming</strong>) to Different Age Levels (Figure 3)</p>
<p><img src="/post/A2-report_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" /></p></li>
</ul>
<p>From the charts (Figure 1, 2 and 3), we can find that the respondents who aged between 30 to 39 years old say “No” to resume mostly frequent. In general, people who are 40 to 59 years old prefer to resume Ontario. This may because they have heavier financial burden so that they need to go back to their work position to make money for family.</p>
<ol start="3" style="list-style-type: decimal">
<li>As to Income, Education and Occupation, the graphs with different levels in terms of the opinion of resuming are shown as following.</li>
</ol>
<ul>
<li><p>Resuming Opinions to Different Income Levels (Figure 4)</p>
<p><img src="/post/A2-report_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Figure 4 illustrates that</p>
<ol style="list-style-type: lower-alpha">
<li><p>Most of the respondents have income between $50,000 to $74,999, which is also includes the mean and median of the income for Ontario.</p></li>
<li><p>Almost all respondents with high income prefer to resume Ontario since they can make more profits when the market is open. However, the people with low income are not willing to reopen due to the CERB from Canada’s government.</p></li>
</ol></li>
<li><p>Resuming Opinions to Different Education Levels (Figure 5)</p>
<p><img src="/post/A2-report_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Through the Figure 5, we can tell that people with lower education level are more willing to resume the Ontario since they have to work physically to make money in most cases while high education people usually have enough ability to make money even if working from home.</p></li>
<li><p>Resuming Opinions to Different Occupations (Figure 6)</p>
<p><img src="/post/A2-report_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Figure 6 shows that most students prefer to resume (totally or conditionally) due to their academic career and social events. Most self-employment people are open to resume in case to overcome the finical burden. To those who work for companies, the number of counts over three opinions are almost identical. That is because such pandemic may not affect their lives too much.</p></li>
</ul>
</div>
<div id="discussion" class="section level1">
<h1>4. Discussion</h1>
<div id="weakness-and-future-work" class="section level2">
<h2>Weakness and Future Work</h2>
<ol style="list-style-type: decimal">
<li><p>In order to avoid missing values, the respondents have to finish all questions before submitting. This will reduce the enthusiasm of the respondents and increase the trouble of repeated sampling.</p></li>
<li><p>We make analysis among the collected data and try to find out the opinions among different groups of people. Since all of our variables are categorical, so it is not proper to do estimation. In the future, we can expend the questionnaire and add some quantitative question to make estimation.</p></li>
</ol>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="github-repo" class="section level2">
<h2>Github repo</h2>
<p><a href="https://github.com/liuluyao54/STA304" class="uri">https://github.com/liuluyao54/STA304</a></p>
<p>All my work can be accessed in ‘content/post/’</p>
</div>
<div id="the-online-survey" class="section level2">
<h2>The online survey</h2>
<p><a href="https://form.jotform.com/202761869971469" class="uri">https://form.jotform.com/202761869971469</a></p>
</div>
<div id="survey-simulation-and-code" class="section level2">
<h2>Survey Simulation and Code</h2>
<div id="simulate-data" class="section level3">
<h3>1. Simulate Data</h3>
<div id="gender" class="section level4">
<h4>(1) Gender</h4>
<p>Give the percentages of Female, Male, Other and ‘Refuse to answer’ as (0.49, 0.49, 0.01, 0.01). Simulate 1000 respondents using this set of weights.</p>
<p>(<a href="https://www.statista.com/statistics/446025/births-in-canada-by-gender/" class="uri">https://www.statista.com/statistics/446025/births-in-canada-by-gender/</a>)</p>
<pre class="r"><code>gender = rep(c(&quot;Female&quot;, &quot;Male&quot;, &quot;Other&quot;, 
               &quot;Refuse to answer&quot;), 
             c(490, 490, 10, 10))
head(gender)</code></pre>
<pre><code>## [1] &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; &quot;Female&quot;</code></pre>
</div>
<div id="age" class="section level4">
<h4>(2) Age</h4>
<p>(<a href="https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1710000501" class="uri">https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1710000501</a>)</p>
<p>From Stats Canada, we can find out the percentages of each age group in Ontario. The percentages for age groups (0-19, 20-29, 30-39, 40-49, 50-59, 60-69, above 69) are (0.125, 0.135, 0.165, 0.150, 0.140, 0.145, 0.140). We then use Stratified Sampling by these weights to simulate the data and then randomize their orders.</p>
<pre class="r"><code>set.seed(123)
# age group
age_try = rep(c(&quot;0-19&quot;, &quot;20-29&quot;,&quot; 30-39&quot;, &quot;40-49&quot;, 
                &quot;50-59&quot;, &quot;60-69&quot;, &quot;above 69&quot;), 
              c(125, 135, 165, 150, 140, 145, 140))
age = sample(age_try)
table(age)</code></pre>
<pre><code>## age
##    30-39     0-19    20-29    40-49    50-59    60-69 above 69 
##      165      125      135      150      140      145      140</code></pre>
</div>
<div id="household-income" class="section level4">
<h4>(3) Household Income</h4>
<p>(<a href="https://www150.statcan.gc.ca/n1/daily-quotidien/200224/dq200224a-eng.htm" class="uri">https://www150.statcan.gc.ca/n1/daily-quotidien/200224/dq200224a-eng.htm</a>)</p>
<p>Also from Stats Canada, we can find out the mean of after-tax income is $63500 and the standard deviation is $12100. Thus, it is reasonable to generate the population(size=10000) under normal distribution and then apply simple random sampling without replacement(SRSWOR) to obtain samples(size = 1000).</p>
<pre class="r"><code># simulate income salaries
set.seed(123)
population = rnorm(10000, mean = 63500, sd = 12100)
income_data = sample(population, size = 1000)
# group data
income = rep(0, 1000)
for (i in c(1:1000))
  if ( income_data[i] &lt; 24999) {
  income[i] = &quot;0-$24,999&quot;
  } else if ( income_data[i] &gt; 25000 &amp; 
              income_data[i] &lt; 49999) {
  income[i] = &quot;$25,000-$49,999&quot;
  } else if ( income_data[i] &gt; 50000 &amp; 
              income_data[i] &lt; 74999) {
  income[i] = &quot;$50,000-$74,999&quot;
  } else if ( income_data[i] &gt; 75000 &amp; 
              income_data[i] &lt; 99999) {
  income[i] = &quot;$75,000-$99,999&quot;
  } else if ( income_data[i] &gt; 100000 &amp; 
              income_data[i] &lt; 149999) {
  income[i] = &quot;$100,000-$149,999&quot;
  } else {
  income[i] = &quot;above $150,000&quot;
  }
table(income)</code></pre>
<pre><code>## income
## $100,000-$149,999   $25,000-$49,999   $50,000-$74,999   $75,000-$99,999 
##                 3               139               711               147</code></pre>
</div>
<div id="education" class="section level4">
<h4>(4) Education</h4>
<p><a href="https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/hlt-fst/edu-sco/index-eng.cfm" class="uri">https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/hlt-fst/edu-sco/index-eng.cfm</a></p>
<p>From Stats Canada, we can find out the percentages of each education group in Ontario. The percentages for education groups (“Less than HS”, “High School”, “College”, “Bachelor”, “Graduate”) are (0.055, 0.155, 0.355, 0.330, 0.105). We then use Stratified Sampling by these weights to simulate the data and then randomize their orders.</p>
<pre class="r"><code># simulate education
set.seed(123)
edu_try = rep(c(&quot;Less than HS&quot;, &quot;High School&quot;, &quot;College&quot;, 
                &quot;Bachelor&quot;, &quot;Graduate&quot;), 
              c(55, 155, 355, 330, 105))
edu = sample(edu_try)
table(edu)</code></pre>
<pre><code>## edu
##     Bachelor      College     Graduate  High School Less than HS 
##          330          355          105          155           55</code></pre>
</div>
<div id="occupation" class="section level4">
<h4>(5) Occupation</h4>
<p><a href="https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/prof/details/page.cfm?Lang=E&amp;Geo1=PR&amp;Code1=35&amp;Geo2=PR&amp;Code2=35&amp;Data=Count&amp;SearchText=&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=Labour" class="uri">https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/prof/details/page.cfm?Lang=E&amp;Geo1=PR&amp;Code1=35&amp;Geo2=PR&amp;Code2=35&amp;Data=Count&amp;SearchText=&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=Labour</a></p>
<p>From Stats Canada, we can find out the percentages of each occupation group in Ontario. The percentages for occupation groups (“Students”, “Work for Company”, “Self-employment”, “Others”) are (0.245, 0.325, 0.280, 0.150). We then use Stratified Sampling by these weights to simulate the data and then randomize their orders.</p>
<pre class="r"><code># simulate occupation
set.seed(123)
occup_try = rep(c(&quot;Students&quot;, &quot;Work for Company&quot;, 
                  &quot;Self-employment&quot;, &quot;Others&quot;), 
                c(245, 325, 280, 150))
occup = sample(occup_try)
table(occup)</code></pre>
<pre><code>## occup
##           Others  Self-employment         Students Work for Company 
##              150              280              245              325</code></pre>
</div>
<div id="covid-19-is-hazard" class="section level4">
<h4>(6) COVID-19 is hazard?</h4>
<p>For this question, I will use the number 1 to represent “Refuse to answer”, number 2,3,4,5 to represent “No”, and number 6,7,8,9,10 to represent “Yes”. These numbers seem like the ranks of the attitude to COVID-19 and somehow represent the true probability of the attitude. Thus, I generate 10000 numbers from 0 to 10 and then SRSWOR from the population to get the samples.</p>
<pre class="r"><code># simulate hazard
set.seed(123)
hazard_popu = rep(c(1:10), 1000)
hazard_try = sample(hazard_popu, size = 1000)
table(hazard_try)</code></pre>
<pre><code>## hazard_try
##   1   2   3   4   5   6   7   8   9  10 
##  99  95  94  95  96 111  98 108 105  99</code></pre>
<pre class="r"><code># group data
hazard = rep(0, 1000)
for (i in c(1:1000))
  if ( hazard_try[i] == 1) {
  hazard[i] = &quot;Refuse&quot;
  } else if ( hazard_try[i] &gt; 1 &amp; hazard_try[i] &lt; 6) {
  hazard[i] = &quot;No&quot;
  } else {
  hazard[i] = &quot;Yes&quot;
  }
table(hazard)</code></pre>
<pre><code>## hazard
##     No Refuse    Yes 
##    380     99    521</code></pre>
</div>
<div id="resume" class="section level4">
<h4>(7) Resume</h4>
<p>For this question, I will use the number 1,2,3 to represent “No”, number 4,5,6,7 to represent “Yes but only some parts”, and number 8,9,10 to represent “Yes and everywhere”. These numbers seem like the ranks of the attitude to COVID-19 and somehow represent the true probability of the attitude. Thus, I generate 10000 numbers from 0 to 10 and then SRSWOR from the population to get the samples.</p>
<pre class="r"><code>set.seed(123)
restart_popu = rep(c(1:10), 1000)
restart_try = sample(restart_popu, size = 1000)
table(restart_try)</code></pre>
<pre><code>## restart_try
##   1   2   3   4   5   6   7   8   9  10 
##  99  95  94  95  96 111  98 108 105  99</code></pre>
<pre class="r"><code># group data
restart = rep(0, 1000)
for (i in c(1:1000))
  if ( restart_try[i] &lt; 4) {
  restart[i] = &quot;No&quot;
  } else if ( restart_try[i] &gt; 3 &amp; restart_try[i] &lt; 8) {
  restart[i] = &quot;Yes but only some parts&quot;
  } else {
  restart[i] = &quot;Yes and everywhere&quot;
  }
table(restart)</code></pre>
<pre><code>## restart
##                      No      Yes and everywhere Yes but only some parts 
##                     288                     312                     400</code></pre>
<pre class="r"><code>data &lt;- data.frame(&quot;Gender&quot; = gender, 
                   &quot;Age&quot; = age, 
                   &quot;Income&quot; = income, 
                   &quot;Education&quot; = edu, 
                   &quot;Occupation&quot; = occup, 
                   &quot;Hazard&quot; = hazard, 
                   &quot;Restart&quot; = restart)
head(data)</code></pre>
<pre><code>##   Gender      Age          Income   Education       Occupation Hazard
## 1 Female    30-39 $50,000-$74,999     College Work for Company     No
## 2 Female    40-49 $50,000-$74,999     College Work for Company Refuse
## 3 Female    20-29 $50,000-$74,999 High School         Students    Yes
## 4 Female    40-49 $50,000-$74,999     College Work for Company    Yes
## 5 Female    20-29 $50,000-$74,999 High School         Students     No
## 6 Female above 69 $25,000-$49,999    Graduate           Others     No
##                   Restart
## 1                      No
## 2                      No
## 3      Yes and everywhere
## 4 Yes but only some parts
## 5                      No
## 6 Yes but only some parts</code></pre>
<pre class="r"><code>table(gender, restart)</code></pre>
<pre><code>##                   restart
## gender              No Yes and everywhere Yes but only some parts
##   Female           143                152                     195
##   Male             142                155                     193
##   Other              3                  1                       6
##   Refuse to answer   0                  4                       6</code></pre>
<pre class="r"><code>table(restart, age)</code></pre>
<pre><code>##                          age
## restart                    30-39 0-19 20-29 40-49 50-59 60-69 above 69
##   No                          48   46    36    46    37    41       34
##   Yes and everywhere          52   32    42    51    44    46       45
##   Yes but only some parts     65   47    57    53    59    58       61</code></pre>
</div>
</div>
<div id="data-analysis-code" class="section level3">
<h3>2. Data Analysis (code)</h3>
<pre class="r"><code>library(dplyr)
library(ggplot2)
attach(mtcars)
par(mfrow=c(1,3))
df1 = data.frame(value = c(39, 47, 49, 39, 39, 43, 32),
                 Group = c( &quot;0-19&quot;, &quot;20-29&quot;, &quot;30-39&quot;, 
                            &quot;40-49&quot;, &quot;50-59&quot;, &quot;60-69&quot;, 
                            &quot;above 69&quot;)) %&gt;%
  # factor levels need to be the opposite order of 
  # the cumulative sum of the values
  mutate(Group = factor(Group, levels = c( &quot;0-19&quot;, &quot;20-29&quot;, 
                                           &quot;30-39&quot;, &quot;40-49&quot;, &quot;50-59&quot;, 
                                           &quot;60-69&quot;, &quot;above 69&quot;)),
         cumulative = cumsum(value),
         midpoint = cumulative - value / 2,
         label = paste0(Group, &quot; &quot;, round(value / sum(value) * 100, 1), &quot;%&quot;))

ggplot(df1, aes(x = 1, weight = value, fill = Group)) +
  geom_bar(width = 1, position = &quot;stack&quot;) +
  coord_polar(theta = &quot;y&quot;) +
  geom_text(aes(x = 1.3, y = midpoint, label = label)) + 
  ggtitle(&quot;Restart Opinion (No) for Different Age Levels&quot;)

df2 = data.frame(value = c(51, 55, 61, 70, 50, 60, 53),
                 Group = c( &quot;0-19&quot;, &quot;20-29&quot;, &quot;30-39&quot;, &quot;40-49&quot;, 
                            &quot;50-59&quot;, &quot;60-69&quot;, &quot;above 69&quot;)) %&gt;%
  # factor levels need to be the opposite order of the 
  # cumulative sum of the values
  mutate(Group = factor(Group, levels = c( &quot;0-19&quot;, &quot;20-29&quot;,
                                           &quot;30-39&quot;, &quot;40-49&quot;,
                                           &quot;50-59&quot;, &quot;60-69&quot;, 
                                           &quot;above 69&quot;)),
         cumulative = cumsum(value),
         midpoint = cumulative - value / 2,
         label = paste0(Group, &quot; &quot;, round(value / sum(value) * 100, 1), &quot;%&quot;))

ggplot(df2, aes(x = 1, weight = value, fill = Group)) +
  geom_bar(width = 1, position = &quot;stack&quot;) +
  coord_polar(theta = &quot;y&quot;) +
  geom_text(aes(x = 1.3, y = midpoint, label = label)) + 
  ggtitle(&quot;Restart Opinion (Yes but only some parts) for Different Age Levels&quot;)


df3 = data.frame(value = c(35, 33, 55, 41, 51, 42, 55),
                 Group = c( &quot;0-19&quot;, &quot;20-29&quot;, &quot;30-39&quot;, &quot;40-49&quot;, 
                            &quot;50-59&quot;, &quot;60-69&quot;, &quot;above 69&quot;)) %&gt;%
  # factor levels need to be the opposite order of 
  # the cumulative sum of the values
  mutate(Group = factor(Group, levels = c( &quot;0-19&quot;, &quot;20-29&quot;, &quot;30-39&quot;, 
                                           &quot;40-49&quot;, &quot;50-59&quot;, &quot;60-69&quot;, 
                                           &quot;above 69&quot;)),
         cumulative = cumsum(value),
         midpoint = cumulative - value / 2,
         label = paste0(Group, &quot; &quot;, round(value / sum(value) * 100, 1), &quot;%&quot;))

ggplot(df3, aes(x = 1, weight = value, fill = Group)) +
  geom_bar(width = 1, position = &quot;stack&quot;) +
  coord_polar(theta = &quot;y&quot;) +
  geom_text(aes(x = 1.3, y = midpoint, label = label)) + 
  ggtitle(&quot;Restart Opinion (Yes and everywhere) for Different Age Levels&quot;)</code></pre>
<pre class="r"><code># Grouped bar plot
ggplot(data, 
       aes(x = restart, 
           fill = income)) + 
  geom_bar(position = &quot;dodge&quot;) + 
  xlab(&quot;Restart Opinions&quot;) +
  ylab(&quot;Counts&quot;) +
  ggtitle(&quot;Restart Opinions for Different Income Levels&quot;)

ggplot(data, 
       aes(x = restart, 
           fill = edu)) + 
  geom_bar(position = &quot;dodge&quot;) + 
  xlab(&quot;Restart Opinions&quot;) +
  ylab(&quot;Counts&quot;) +
  ggtitle(&quot;Restart Opinions for Different Education Levels&quot;)

ggplot(data, 
       aes(x = restart, 
           fill = occup)) + 
  geom_bar(position = &quot;dodge&quot;) + 
  xlab(&quot;Restart Opinions&quot;) +
  ylab(&quot;Counts&quot;) +
  ggtitle(&quot;Restart Opinions for Different Occupations&quot;)</code></pre>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-of2020species">
<p>International, Coronaviridae Study Group of the, and others. 2020. “The Species Severe Acute Respiratory Syndrome-Related Coronavirus: Classifying 2019-nCoV and Naming It Sars-Cov-2.” <em>Nature Microbiology</em> 5 (4): 536.</p>
</div>
<div id="ref-lohr2009sampling">
<p>Lohr, Sharon L. 2009. <em>Sampling: Design and Analysis</em>. Nelson Education.</p>
</div>
</div>
</div>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

